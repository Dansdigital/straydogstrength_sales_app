import { remove } from '@aws-amplify/storage/internals';
import { constructBucket } from './utils.mjs';

const deleteHandler = ({ config, data, }) => {
    const { key } = data;
    const { accountId, credentials, customEndpoint } = config;
    const result = remove({
        path: key,
        options: {
            bucket: constructBucket(config),
            locationCredentialsProvider: credentials,
            expectedBucketOwner: accountId,
            customEndpoint,
        },
    })
        .then(({ path }) => ({
        status: 'COMPLETE',
        value: { key: path },
    }))
        .catch((error) => {
        const { message } = error;
        return { error, message, status: 'FAILED' };
    });
    return { result };
};

export { deleteHandler };
