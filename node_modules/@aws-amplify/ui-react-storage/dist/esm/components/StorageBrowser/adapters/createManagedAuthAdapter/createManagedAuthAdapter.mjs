import { createLocationCredentialsHandler } from './createLocationCredentialsHandler.mjs';
import '@aws-amplify/storage/internals';
import '@aws-amplify/ui';
import 'aws-amplify/storage';
import { listLocationsHandler } from '../../actions/handlers/listLocations.mjs';
import '../../actions/configs/context.mjs';
import '../../actions/configs/defaults.mjs';

/**
 * Create configuration including handlers to call S3 Access Grant APIs to list and get
 * credentials for different locations.
 *
 * @param options - Configuration options for the adapter.
 * @returns - An object containing the handlers to call S3 Access Grant APIs and region
 */
const createManagedAuthAdapter = ({ accountId, credentialsProvider, customEndpoint, region, registerAuthListener, }) => {
    const config = {
        accountId,
        credentials: credentialsProvider,
        customEndpoint,
        region,
    };
    const listLocations = ({ options } = {}) => listLocationsHandler({ config, options });
    const getLocationCredentials = createLocationCredentialsHandler({
        credentialsProvider,
        accountId,
        customEndpoint,
        region,
    });
    return {
        accountId,
        listLocations,
        getLocationCredentials,
        region,
        registerAuthListener,
    };
};

export { createManagedAuthAdapter };
