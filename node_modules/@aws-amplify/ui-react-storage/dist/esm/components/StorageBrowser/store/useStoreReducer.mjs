import { useControlledReducer } from '@aws-amplify/ui-react-core';
import storeReducer from './storeReducer.mjs';
import { getInitialState, getState } from './utils.mjs';
import validateStoreProps from './validateStoreProps.mjs';

function useStoreReducer(props) {
    validateStoreProps(props);
    const { defaultValue, onValueChange, value, ...legacyProps } = props;
    const initialState = getInitialState(defaultValue, legacyProps);
    const controlledState = value !== undefined ? getState(value) : undefined;
    const onStateChange = ({ actionType, location: { current, path }, }) => {
        const location = !current ? undefined : { ...current, path };
        onValueChange?.({ actionType, location });
    };
    return useControlledReducer(storeReducer, initialState, {
        controlledState,
        onStateChange,
    });
}

export { useStoreReducer as default };
